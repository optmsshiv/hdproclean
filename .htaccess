# -----------------------------------
# Force HTTPS
# -----------------------------------
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond % { HTTPS } !=on
RewriteRule ^ https://% { HTTP_HOST }% { REQUEST_URI } [L, R=301]
</IfModule>

# -----------------------------------
# Redirect www to non-www
# -----------------------------------
<IfModule mod_rewrite.c>
RewriteCond % { HTTP_HOST } ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301, L]
</IfModule>

# -----------------------------------
# Remove .html extension
# -----------------------------------
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond % { REQUEST_FILENAME } !-d
RewriteCond % { REQUEST_FILENAME }.html -f
RewriteRule ^(.*)$ $1.html [L]
</IfModule>

# -----------------------------------
# Custom Error Pages
# -----------------------------------
ErrorDocument 404 /404.html
ErrorDocument 403 /403.html

# -----------------------------------
# Gzip Compression
# -----------------------------------
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css
AddOutputFilterByType DEFLATE application/xml application/xhtml+xml application/rss+xml
AddOutputFilterByType DEFLATE application/javascript application/x-javascript
</IfModule>

# -----------------------------------
# Browser Caching
# -----------------------------------
<IfModule mod_expires.c>
ExpiresActive On
ExpiresByType image/jpg "access plus 1 year"
ExpiresByType image/jpeg "access plus 1 year"
ExpiresByType image/png "access plus 1 year"
ExpiresByType image/gif "access plus 1 year"
ExpiresByType image/svg+xml "access plus 1 year"
ExpiresByType text/css "access plus 1 month"
ExpiresByType application/javascript "access plus 1 month"
ExpiresByType text/html "access plus 1 hour"
</IfModule>

# -----------------------------------
# Security Headers (Safe)
# -----------------------------------
<IfModule mod_headers.c>
Header set X-Content-Type-Options "nosniff"
Header set X-XSS-Protection "1; mode=block"
Header set X-Frame-Options "SAMEORIGIN"
Header set Referrer-Policy "no-referrer-when-downgrade"
</IfModule>

# -----------------------------------
# Disable Directory Browsing
# -----------------------------------
Options -Indexes
